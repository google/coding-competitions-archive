
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam 2020 - Round 1B</h3><h1>Join the Ranks</h1><h3>Problem</h3>
<p>
  You recently acquired a new deck of cards. Each card displays a rank, which
  is an integer between 1 and <b>R</b>, and a suit, which is an integer between
  1 and <b>S</b>. For each combination of a rank and a suit, there is exactly
  one card that displays it, meaning that the deck has <b>R</b> &times;
  <b>S</b> cards in total. We will denote a card with rank r and suit s as
  (r, s).
</p><p>
  Being brand new, the deck is sorted from top to bottom by suit in increasing
  order, with ties being broken by ranks in increasing order. That is, (1, 1)
  comes first, then (2, 1), ..., (<b>R</b>, 1), then (1, 2), (2, 2), ...,
  (<b>R</b>, 2), and so on up to (<b>R</b>, <b>S</b>). For example, with
  <b>R</b> = 4 ranks and <b>S</b> = 2 suits, the initial ordering would be:
  (1, 1), (2, 1), (3, 1), (4, 1), (1, 2), (2, 2), (3, 2), (4, 2).
</p><p>
  You want to reorder the deck to be sorted by rank. That is, you want to put
  all the cards of the same rank together, and have the ranks be in increasing
  order. You do not care, however, about the order of the suits within each
  rank. For example, with <b>R</b> = 4 and <b>S</b> = 2, one of the various
  possible valid new orderings would be: (1, 2), (1, 1), (2, 1), (2, 2), (3, 1),
  (3, 2), (4, 2), (4, 1).
</p><p>
  You have been learning how to cook, so you want to reorder the deck without
  putting your spatulas down. You decided to sort the deck using only the
  following multi-part operation:
<ul>
  <li>First, take one or more cards from the top of the deck, and set that
    selection aside as pile A.</li>
  <li>Next, take one or more cards from the new top of the deck, and set that
    selection aside as pile B.</li>
  <li>Finally, put pile A on top of the deck, and then put pile B on top of
    the new deck.
</ul>
<p>
  Notice that the operation exchanges the pile A part of the deck and the pile
  B part of the deck, without affecting any other cards deeper in the deck (if
  there are any).
</p><p>
  Continuing with our <b>R</b> = 4, <b>S</b> = 2 example, if your first move is
  to choose 3 cards from the top for pile A and 2 cards for pile B, then these
  are the cards you get:<br/>
  A: (1, 1), (2, 1), (3, 1),<br/>
  B: (4, 1), (1, 2), and<br/>
  Remainder of deck: (2, 2), (3, 2), (4, 2).<br/>
  After putting A on the deck and then B on top of that, the new deck is
  ordered like this:<br/>
  (4, 1), (1, 2), (1, 1), (2, 1), (3, 1), (2, 2), (3, 2), (4, 2).
</p><p>
  Given <b>R</b> and <b>S</b>, find a sequence of operations that reorders the
  deck to be sorted by rank, as described above, and uses the minimum possible
  number of operations to do so.
</p>

<h3>Input</h3>
<p>
  The first line of the input gives the number of test cases, <b>T</b>.
  <b>T</b> lines follow. Each of these lines describes a single test case with
  two integers <b>R</b> and <b>S</b>, the number of ranks and suits in the
  deck, respectively.
</p>

<h3>Output</h3>
<p>
  For each test case, output one line containing <code>Case #x: y</code>,
  where <code>x</code> is the test case number (starting from 1) and
  <code>y</code> is the minimum number of operations needed to reorder the deck
  as explained above. Then, print <code>y</code> more lines containing
  <code>a<sub>i</sub> b<sub>i</sub></code>, meaning that in the i-th operation
  in a sequence of moves that reorders the deck, you take
  <code>a<sub>i</sub></code> cards first to form pile A and then
  <code>b<sub>i</sub></code> cards after that to form pile B.
</p>

<h3>Limits</h3>
<p>
  Memory limit: 1GB.<br/>
</p>

<h4>Test set 1 (Visible Verdict)</h4>
<p>
  Time limit: 30 seconds.<br/>
  <b>T</b> = 12.<br/>
  2 &le; <b>R</b> &le; 5.<br/>
  2 &le; <b>S</b> &le; 7.<br/>
  <b>R</b> &times; <b>S</b> &le; 14.<br/>
</p>

<h4>Test set 2 (Hidden Verdict)</h4>
<p>
  Time limit: 60 seconds.<br/>
  1 &le; <b>T</b> &le; 100.<br/>
  2 &le; <b>R</b> &le; 40.<br/>
  2 &le; <b>S</b> &le; 40.<br/>
</p>


  <h3>Sample</h3>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="join_the_ranks_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">3
2 2
3 2
2 3
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="join_the_ranks_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: 1
2 1
Case #2: 2
3 2
2 1
Case #3: 2
2 3
2 2
</pre>
        </div>
      </div>
    </div>
  </div>


<p>
  In Sample Case #1, the initial order is
  <nobr>(1, 1), (2, 1), (1, 2), (2, 2).</nobr> After swapping
  <nobr>A = (1, 1), (2, 1)</nobr> and <nobr>B = (1, 2)</nobr> the deck is left
  as <nobr>(1, 2), (1, 1), (2, 1), (2, 2)</nobr>, which is sorted by rank as
  needed. Notice that the suits are in different orders within each rank, which
  is allowed.
</p><p>
  In Sample Case #2, the initial order is
  <nobr>(1, 1), (2, 1), (3, 1), (1, 2), (2, 2), (3, 2).</nobr>
  After swapping <nobr>A = (1, 1), (2, 1), (3, 1)</nobr> and
  <nobr>B = (1, 2), (2, 2)</nobr> the deck is left as
  <nobr>(1, 2), (2, 2), (1, 1), (2, 1), (3, 1), (3, 2).</nobr>
  In a second move, we can do <nobr>A = (1, 2), (2, 2)</nobr> and
  <nobr>B = (1, 1)</nobr> to get
  <nobr>(1, 1), (1, 2), (2, 2), (2, 1), (3, 1), (3, 2).</nobr>
</p><p>
  In Sample Case #3, another valid solution is <code>a<sub>1</sub></code> = 4,
  <code>b<sub>1</sub></code> = 1 first, and then <code>a<sub>2</sub></code> = 3
  and <code>b<sub>2</sub></code> = 1.
</p>

    </div>
  </body>
</html>
